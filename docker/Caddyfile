# Snippet for proxy rules (reusable)
(proxy_rules) {
    handle /api/* {
        reverse_proxy backend:8989
    }
    handle /webhook* {
        reverse_proxy backend:8989
    }
    handle {
        reverse_proxy frontend:3000
    }
}

# HTTP fallback - always available for any hostname
:80 {
    import proxy_rules
}

# HTTPS with auto SSL - only active if DOMAIN is set to a real FQDN
{$DOMAIN:} {
    import proxy_rules
}
